   10 REM > 3DTXT
   20 
   30 SYS"OS_UpdateMEMC",64,64
   40 ONERRORGOTO620
   50 DIM XW(1000),YW(1000),ZW(1000)
   60 DIM XR(1000),YR(1000),ZR(1000)
   70 DIM XS(1000),YS(1000)
   80 DIM plot(1000),point(1000)
   90 MODE0:MODE128:SP%=1
  100 ORIGIN 640,512:OFF
  110 COLOUR 0,4
  120 XROT=0:YROT=0:ZROT=0
  130 XPOS=0
  140 YPOS=0
  150 ZPOS=220
  160 PROCINIT
  170 REPEAT
  180 PROCROTATE
  190 SP%=3-SP%:WAIT
  200 OSCLI"FX113,"+STR$SP%
  210 OSCLI"FX112,"+STR$(3-SP%)
  220 CLS
  230 PROCPLOT
  240 IF INKEY(-123) YROT+=5
  250 IF INKEY(-27) YROT-=5
  260 IF INKEY(-28) ZROT+=5
  270 IF INKEY(-44) ZROT-=5
  280 IF INKEY(-108) XROT+=5
  290 IF INKEY(-109) XROT-=5
  300 IF INKEY(-125) ZPOS+=5
  310 IF INKEY(-43) ZPOS-=5
  320 IF INKEY(-26) XPOS-=5
  330 IF INKEY(-122) XPOS+=5
  340 IF INKEY(-58) YPOS+=5
  350 IF INKEY(-42) YPOS-=5
  360 IF INKEY(-33) PROCDUMP
  370 UNTIL FALSE
  380 END
  390 :
  400 DEFPROCROTATE
  410 FOR I%=1 TO coords
  420 XA=XW(I%):YA=YW(I%):ZA=ZW(I%)
  430 XR=XA*COS(RAD(ZROT))-YA*SIN(RAD(ZROT))
  440 YA=YA*COS(RAD(ZROT))+XA*SIN(RAD(ZROT))
  450 XA=XR
  460 XR=XA*COS(RAD(YROT))-ZA*SIN(RAD(YROT))
  470 ZA=ZA*COS(RAD(YROT))+XA*SIN(RAD(YROT))
  480 XA=XR
  490 YR=YA*COS(RAD(XROT))-ZA*SIN(RAD(XROT))
  500 ZA=ZA*COS(RAD(XROT))+YA*SIN(RAD(XROT))
  510 YA=YR
  520 XR(I%)=XA+XPOS:YR(I%)=YA+YPOS:ZR(I%)=ZA+ZPOS
  530 XS(I%)=800*XR(I%)/ZR(I%)
  540 YS(I%)=800*YR(I%)/ZR(I%)
  550 NEXT:ENDPROC
  560 :
  570 DEFPROCPLOT
  580 FOR P%=1 TO lines
  590 PLOT plot(P%),XS(point(P%)),YS(point(P%))
  600 NEXT:ENDPROC
  610 
  620 *FX112,1
  630 *FX113,1
  640 ON:REPORT:PRINT" at line "ERL
  650 END
  660 
  670 DEFPROCINIT
  680 CP%=0:Z%=4
  690 
  700 INPUT"Indtast tekst "A$:CLS
  710 FX%=6*LENA$*Z%:FY%=6*Z%
  720 
  730 XP%=0:YP%=0
  740 FORN%=1TOLENA$
  750 RESTORE 1300:B$=MID$(A$,N%,1)
  760 IF INSTR("ABCDEFGHIJKLMNOPQRSTUVWXYZ",B$)=0 THEN 850
  770 REPEAT:READC$:UNTILC$=B$
  780 REPEAT:READ P%,X%,Y%
  790 X%=XP%+Z%*X%-FX%:Y%=YP%+Z%*Y%-FY%
  800 IF P%<>0 THEN
  810 CP%=CP%+1:plot(CP%)=P%:point(CP%)=CP%
  820 XW(CP%)=X%:YW(CP%)=Y%:ZW(CP%)=Z%
  830 ENDIF
  840 UNTILP%=0
  850 XP%=XP%+Z%*14
  860 NEXT
  870 
  880 XP%=0:YP%=0:CP1%=CP%
  890 FORN%=1TOLENA$
  900 RESTORE 1300:B$=MID$(A$,N%,1)
  910 IF INSTR("ABCDEFGHIJKLMNOPQRSTUVWXYZ",B$)=0 THEN 1000
  920 REPEAT:READC$:UNTILC$=B$
  930 REPEAT:READ P%,X%,Y%
  940 X%=XP%+Z%*X%-FX%:Y%=YP%+Z%*Y%-FY%
  950 IF P%<>0 THEN
  960 CP%=CP%+1:plot(CP%)=P%:point(CP%)=CP%
  970 XW(CP%)=X%:YW(CP%)=Y%:ZW(CP%)=-Z%
  980 ENDIF
  990 UNTILP%=0
 1000 XP%=XP%+Z%*14
 1010 NEXT
 1020 
 1030 coords=CP%
 1040 
 1050 FORN%=1TOCP1%:N1%=N%+CP1%
 1060 CP%=CP%+1:plot(CP%)=4:point(CP%)=N%
 1070 CP%=CP%+1:plot(CP%)=5:point(CP%)=N1%
 1080 NEXT
 1090 
 1100 lines=CP%
 1110 
 1120 ENDPROC
 1130 
 1140 DEFPROCDUMP
 1150 LOCAL X%,Y%,A%,B%
 1160 OSCLI"FX112,"+STR$SP%
 1170 ORIGIN 0,0
 1180 VDU2,1,27,1,51,1,21
 1190 FORY%=1008TO0STEP-16
 1200 VDU1,27,1,75,1,128,1,2
 1210 FORX%=0TO1278STEP2:A%=0:B%=%11
 1220 FORI%=0TO12STEP4
 1230 IFPOINT(X%,Y%+I%)=1 A%=A%+B%
 1240 B%=B%<<2:NEXT:VDU1,A%:NEXT
 1250 NEXT:VDU1,27,1,64,3
 1260 ORIGIN 640,512
 1270 OSCLI"FX112,"+STR$(3-SP%)
 1280 ENDPROC
 1290 
 1300 DATAA,4,0,0,5,0,12,5,2,14,5,8,14,5,10,12
 1310 DATA5,10,0,5,8,0,5,8,6,5,2,6,5,2,0
 1320 DATA5,0,0,4,2,8,5,8,8,5,8,11,5,7,12
 1330 DATA5,3,12,5,2,11,5,2,8,0,0,0
 1340 DATAB,4,0,0,5,0,14,5,8,14,5,10,12,5,10,8
 1350 DATA5,9,7,5,10,6,5,10,2,5,8,0,5,0,0
 1360 DATA4,2,2,5,7,2,5,8,3,5,8,5,5,7,6,5,2,6
 1370 DATA5,2,2,4,2,8,5,7,8,5,8,9,5,8,11
 1380 DATA5,7,12,5,2,12,5,2,8,0,0,0
 1390 DATAC,4,0,2,5,0,12,5,2,14,5,8,14,5,10,12
 1400 DATA5,10,9,5,8,9,5,8,11,5,7,12,5,3,12
 1410 DATA5,2,11,5,2,3,5,3,2,5,7,2,5,8,3
 1420 DATA5,8,5,5,10,5,5,10,2,5,8,0,5,2,0
 1430 DATA5,0,2,0,0,0
 1440 DATAD,4,0,0,5,0,14,5,8,14,5,10,12,5,10,2
 1450 DATA5,8,0,5,0,0,4,2,2,5,2,12,5,7,12
 1460 DATA5,8,11,5,8,3,5,7,2,5,2,2,0,0,0
 1470 DATAE,4,0,0,5,0,14,5,10,14,5,10,12
 1480 DATA5,2,12,5,2,8,5,8,8,5,8,6,5,2,6
 1490 DATA5,2,2,5,10,2,5,10,0,5,0,0,0,0,0
 1500 DATAF,4,0,0,5,0,14,5,10,14,5,10,12
 1510 DATA5,2,12,5,2,8,5,8,8,5,8,6,5,2,6
 1520 DATA5,2,0,5,0,0,0,0,0
 1530 DATAG,4,0,2,5,0,12,5,2,14,5,8,14,5,10,12
 1540 DATA5,10,9,5,8,9,5,8,11,5,7,12,5,3,12
 1550 DATA5,2,11,5,2,3,5,3,2,5,7,2,5,8,3
 1560 DATA5,8,5,5,6,5,5,6,7,5,10,7,5,10,2
 1570 DATA5,8,0,5,2,0,5,0,2,0,0,0
 1580 DATAH,4,0,0,5,0,14,5,2,14,5,2,8,5,8,8
 1590 DATA5,8,14,5,10,14,5,10,0,5,8,0,5,8,6
 1600 DATA5,2,6,5,2,0,5,0,0,0,0,0
 1610 DATAI,4,4,0,5,4,14,5,6,14,5,6,0,5,4,0
 1620 DATA0,0,0
 1630 DATAJ,4,1,2,5,1,5,5,3,5,5,3,3,5,4,2
 1640 DATA5,6,2,5,7,3,5,7,14,5,9,14,5,9,2
 1650 DATA5,7,0,5,3,0,5,1,2,0,0,0
 1660 DATAK,4,0,0,5,0,14,5,2,14,5,2,8,5,7,14
 1670 DATA5,10,14,5,4,7,5,10,0,5,7,0,5,2,6
 1680 DATA5,2,0,5,0,0,0,0,0
 1690 DATAL,4,0,0,5,0,14,5,2,14,5,2,2,5,10,2
 1700 DATA5,10,0,5,0,0,0,0,0
 1710 DATAM,4,0,0,5,0,14,5,2,14,5,5,8,5,8,14
 1720 DATA5,10,14,5,10,0,5,8,0,5,8,10,5,5,4
 1730 DATA5,2,10,5,2,0,5,0,0,0,0,0
 1740 DATAN,4,0,0,5,0,14,5,2,14,5,8,4,5,8,14
 1750 DATA5,10,14,5,10,0,5,8,0,5,2,10,5,2,0
 1760 DATA5,0,0,0,0,0
 1770 DATAO,4,0,2,5,0,12,5,2,14,5,8,14,5,10,12
 1780 DATA5,10,2,5,8,0,5,2,0,5,0,2,4,2,3,5,2,11
 1790 DATA5,3,12,5,7,12,5,8,11,5,8,3,5,7,2
 1800 DATA5,3,2,5,2,3,0,0,0
 1810 DATAP,4,0,0,5,0,14,5,8,14,5,10,12,5,10,8
 1820 DATA5,8,6,5,2,6,5,2,0,5,0,0,4,2,8,5,7,8
 1830 DATA5,8,9,5,8,11,5,7,12,5,2,12,5,2,8
 1840 DATA0,0,0
 1850 DATAQ,4,0,2,5,0,12,5,2,14,5,8,14,5,10,12
 1860 DATA5,10,3,5,9,2,5,10,1,5,10,0,5,9,0
 1870 DATA5,8,1,5,7,0,5,2,0,5,0,2,4,2,3,5,2,11
 1880 DATA5,3,12,5,7,12,5,8,11,5,8,3,5,7,4
 1890 DATA5,6,4,5,6,3,5,7,2,5,3,2,5,2,3
 1900 DATA0,0,0
 1910 DATAR,4,0,0,5,0,14,5,8,14,5,10,12,5,10,8
 1920 DATA5,8,6,5,5,6,5,10,0,5,7,0,5,2,6
 1930 DATA5,2,0,5,0,0,4,2,8,5,7,8,5,8,9,5,8,11
 1940 DATA5,7,12,5,2,12,5,2,8,0,0,0
 1950 DATAS,4,0,2,5,0,5,5,2,5,5,2,3,5,3,2
 1960 DATA5,7,2,5,8,3,5,8,5,5,7,6,5,2,6,5,0,8
 1970 DATA5,0,12,5,2,14,5,8,14,5,10,12,5,10,9
 1980 DATA5,8,9,5,8,11,5,7,12,5,3,12,5,2,11
 1990 DATA5,2,9,5,3,8,5,8,8,5,10,6,5,10,2
 2000 DATA5,8,0,5,2,0,5,0,2,0,0,0
 2010 DATAT,4,4,0,5,4,12,5,0,12,5,0,14,5,10,14
 2020 DATA5,10,12,5,6,12,5,6,0,5,4,0
 2030 DATA0,0,0
 2040 DATAU,4,0,2,5,0,14,5,2,14,5,2,3,5,3,2
 2050 DATA5,7,2,5,8,3,5,8,14,5,10,14,5,10,2
 2060 DATA5,8,0,5,2,0,5,0,2,0,0,0
 2070 DATAV,4,4,0,5,0,14,5,2,14,5,5,4,5,8,14
 2080 DATA5,10,14,5,6,0,5,4,0,0,0,0
 2090 DATAW,4,0,0,5,0,14,5,2,14,5,2,4,5,5,9
 2100 DATA5,8,4,5,8,14,5,10,14,5,10,0,5,8,0
 2110 DATA5,5,5,5,2,0,5,0,0,0,0,0
 2120 DATAX,4,0,0,5,0,3,5,4,7,5,0,11,5,0,14
 2130 DATA5,2,14,5,2,12,5,5,9,5,8,12,5,8,14
 2140 DATA5,10,14,5,10,11,5,6,7,5,10,3,5,10,0
 2150 DATA5,8,0,5,8,2,5,5,5,5,2,2,5,2,0,5,0,0
 2160 DATA0,0,0
 2170 DATAY,4,4,0,5,4,7,5,0,11,5,0,14,5,2,14
 2180 DATA5,2,12,5,5,9,5,8,12,5,8,14,5,10,14
 2190 DATA5,10,11,5,6,7,5,6,0,5,4,0
 2200 DATA0,0,0
 2210 DATAZ,4,0,0,5,0,2,5,7,12,5,0,12,5,0,14
 2220 DATA5,10,14,5,10,12,5,3,2,5,10,2,5,10,0
 2230 DATA5,0,0,0,0,0
